#HTTP协议

##一：概述
HTTP协议（Hypertext Transfer Protocol，超文本传输协议）是一个简单的请求-响应协议，属于应用层协议。
它通常使用TCP连接传送，保证了数据的可靠传输，但是HTTP协议**本身是无连接的**，虽然HTTP使用了TCP连接，
但是通信双方在交换HTTP报文之前不需要先建立HTTP连接。  
HTTP协议是**无状态的（stateless）**，也就是说，同一个客户第二次访问同一个服务器上的资源时，服务器的
响应与第一次被访问时的相同，因为服务器并不知道曾经访问过得这个客户。HTTP协议的无状态性简化了服务器的设
计，使服务器更容易支持大量并发的HTTP请求。

##二：HTTP的连接和请求过程
HTTP请求发生时，首先要和服务器建立TCP连接。TCP的建链过程需要三次握手。当TCP建链的三次握手报文的前两个
报文完成后，客户端就把HTTP的请求报文，作为TCP建链过程三次握手中的第三个报文发送给服务器。服务器收到HTTP
请求报文后，处理完成再把响应报文返回给客户端。如下图所示：    
![HTTP connect](image/HTTP_connect.png)

从上面可以看出，一个HTTP请求所需要的事件是2倍往返时间RTT（一个RTT用于TCP建链，连一个RTT用于请求和接收响应）。
HTTP/1.0的主要缺点就是每次请求都要两倍的RTT消耗。  

HTTP/1.1协议较好的解决了这个问题，客户端和服务器完成一个请求和响应后仍然在一段时间内保持这条连接，使该客户端
可以继续使用这条连接传送后续的HTTP请求报文。

HTTP/1.1有两种工作方式：  
1. **非流水线方式（without pipelining）**：客户端在收到前一个响应后才能发出下一个请求。在TCP建链完成后，
客户端的后续每次请求都只用一个往返时间RTT，节省了TCP建链所需要的一个RTT时间。缺点是服务器在发送完一个响应
后，其TCP连接就处于空闲状态，浪费了服务器资源。

2. **流水线方式（with pipelining）**： 客户端在收到HTTP响应之前就能够接着发送新的请求报文。多个请求报文
连续发送到服务器后，服务器就可以连续发回响应报文。因此，使用流水线方式使得TCP连接中的空闲时间减少，提高效率。

##三：HTTP报文结构
HTTP有两类报文：
1. **请求报文**：从客户端向服务器发送的报文。
2. **响应报文**：从服务器到客户端的应答。

HTTP的报文格式如下图所示：  
![HTTP format](image/HTTP_format.png)

1. **开始行** ：用于区分是请求报文还是响应报文。在请求报文中叫做**请求行（Request-Line）**，
在响应报文中叫做**状态行（Status-Line）**。开始行的三个字段之间都已空格分开，最后的**CR和LF**
分别代表**回车和换行**。
    - **请求行-方法**： 就是所请求的对象进行的**操作**，包括：**PUT、GET、POST、DELETE**等。
    - **请求行-URL**： 统一资源定位符。
    - **版本**： HTTP协议版本，HTTP/1.0或HTTP/1.1。
    - **状态行-状态码**： 都是三维数字，分为5大类，每一类都以相同的数字开头。
    - **状态行-短语**： 用来解释状态码的简单短语。
2. **首部行** ：就是常说的报文头，用来说明客户端、服务器或报文主题的一些信息。首部可以有0到多行，
每一行都是由首部字段名和它的值组成（name:value），每一行也都已**回车和换行**结束。首部结束时，
还有一空行将首部和后面的实体主题分开。

3. **实体主体（entiry body）** ：就是常说的报文体，只有在POST操作种才会有。

### 常用的操作及意义
|操作（方法）|意义|
|----------|---|
|OPTION|请求一些选项的信息|
|GET|请求读取由URL所标志的信息|
|HEAD|请求读取由URL所标志的信息的首部|
|POST|给服务器添加信息|
|PUT|在指明的URL下存储一个文档|
|DELETE|删除指明的URL所标志的资源|
|TRACE|用来进行环回测试的请求报文|
|CONNECT|用于代理服务器|


###状态码的五大类别
1. 1xx：表示通知信息，如秦秋收到了或正在进行处理。
2. 2xx：表示成功，如接受或知道了。
3. 3xx：表示重定向，如要完成请求还必须采取进一步的行动。
4. 4xx：表示客户的差错，如请求中有错误语法或不能完成。
5. 5xx：表示服务器的差错，如服务器无效无法完成请求。

